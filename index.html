<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-signin-client_id" content="904131214369-65d67s90qk1bdcejksng18v2km84dqma.apps.googleusercontent.com">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
    <link rel="stylesheet" href="./assets/css/style.css">
    
    <!-- <script src="https://apis.google.com/_/scs/apps-static/_/js/k=oz.gapi.id.m6xmrKhMnzI.O/m=auth2/exm=client/rt=j/sv=1/d=1/ed=1/am=wQE/rs=AGLTcCOvT9kmlrAoUqO0PFVu1G-earGnXA/cb=gapi.loaded_1" async=""></script>
    <script src="https://apis.google.com/_/scs/apps-static/_/js/k=oz.gapi.id.m6xmrKhMnzI.O/m=client/rt=j/sv=1/d=1/ed=1/am=wQE/rs=AGLTcCOvT9kmlrAoUqO0PFVu1G-earGnXA/cb=gapi.loaded_0" async=""></script> -->
    <!-- <script src="https://apis.google.com/js/platform.js" async defer gapi_processed="true"></script> -->
    <script src="https://apis.google.com/js/platform.js?onload=onLoadCallback" async defer></script>  

    <title>Kanban</title>
  </head>
  <body>
    <div id="app">
      <!-- login -->
      <section class="d-flex justify-content-center align-items-center bg-login" v-if="page === 'login'">
        <!-- login form -->
        <div class="card login-card" v-if="!isRegister">
          <div class="login-title">Login</div>
          <form @submit.prevent="login">
            <div>
              <input type="email" v-model="user.email" placeholder="email">
            </div>
            <div>
              <input type="password" v-model="user.password" placeholder="password">
            </div>
            <div class="d-flex justify-content-center my-3">
              <button type="submit" class="btn mx-2">Login</button>
              <a class="btn mx-2" @click="changeRegister(true)">Register</a>
            </div>
          </form>
          <div class="d-flex justify-content-center">
            <div class="g-signin2" data-onsuccess="onSignIn"></div>
          </div>
        </div>
        <!-- register form -->
        <div class="card login-card" v-else>
          <div class="login-title">Register</div>
          <form @submit.prevent="register">
            <div>
              <input type="email" v-model="user.email" placeholder="email">
            </div>
            <div>
              <input type="password" v-model="user.password" placeholder="password">
            </div>
            <div class="d-flex justify-content-center my-3">
              <button type="submit" class="btn mx-2">Create</button>
              <a class="btn mx-2" @click="changeRegister(false)">Back</a>
            </div>
          </form>
        </div>
      </section>

      <section v-if="page === 'main'">
        <!-- navbar -->
        <nav>
          <nav class="navbar navbar-expand-lg navbar-light">
            <div class="container-fluid justify-content-between">
              <div class="nav-item">
                <a class="nav-link text-white">Home</a>
              </div>
              <div class="logo">Kanban</div>
              <div class="dropdown">
                <a class="text-white dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
                  {{ username }}
                </a>
              
                <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                  <li><a class="dropdown-item" @click="logout">Logout</a></li>
                </ul>
              </div>
            </div>
          </nav>
        </nav>

        <!-- task -->
        <div class="mx-2">
          <div class="row">
            <div class="col-3" v-for="category in categories">
              <div class="card bg-light">
                <div class="card-header" >
                  <div class="title" v-text="category"></div>
                  <div><i class="fas fa-ellipsis-h"></i></div>
                </div>
                <div class="card-content"  v-for="task in tasks" :key="task.id">
                  <div class="card bg-white p-1 mb-2" v-if="task.category == category" :id="task.id">
                    <div>
                      <div v-if="isEdit == task.id">
                        <form @submit.prevent="editTodo(task.id, category)">
                          <textarea v-model="title" rows="3" class="form-control"></textarea>
                          <button type="submit" class="btn btn-success">save</button>
                          <a class="btn btn-danger" @click="cancel">cancel</a>
                        </form>
                      </div>
                      <div v-text="task.title" v-else @dblclick="showFormEdit(task.id)"></div>
                    </div>
                    <div class="edit">
                      <i class="fas fa-pen" @click="showFormEdit(task.id)"></i>
                      <i class="fas fa-trash-alt" @click="confirmDelete(task.id)"></i>
                      <i class="fas fa-arrows-alt" @click="showMoveForm(task.id, category)"></i>
                    </div>
                    <small>by: {{task.User.email}} </small>
                  </div>
                </div>
                <div v-if="isAdd === category" class="card-content">
                  <div class="card bg-white p-1 mb-2">
                    <div>
                      <form @submit.prevent="addTodo(category)">
                        <textarea v-model="titleAdd" rows="3" class="form-control"></textarea>
                        <button type="submit" class="btn btn-success">save</button>
                        <button class="btn btn-danger" @click="cancel">cancel</button>
                      </form>
                    </div>
                  </div>
                </div>
                <div class="card-footer">
                  <div @click="showFormAdd(category)"><i class="fas fa-plus"></i> Add another card</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="./assets/js/main.js"></script>
  </body>
</html>